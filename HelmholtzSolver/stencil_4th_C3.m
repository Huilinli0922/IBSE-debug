function ret = stencil_4th_C3(r,h,D)
%	getOPconti
% 		get stencils for my smooth delta function (4th order, C^2)
% 		note that this delta meets neither the balanced condition
% 		nor the sum of squares condition
% 		r = distance
% 		h = grid spacing
% 		D = derivative
%
%       David Stein
%

Ret = sparse(0*r(:));
r = r/h;
I = find( abs(r) < 10 )';
for i = I
    ret = 0;
    rr = r(i);
    if D == 0
        if -8 < rr && rr <= -7
            ret = rr.^15/1307674368000 + rr.^14/10897286400 + 47*rr.^13/9340531200 + rr.^12/5987520 + 299*rr.^11/79833600 + 2447*rr.^10/40824000 + 69019*rr.^9/97977600 + 58621*rr.^8/9525600 + 1825543*rr.^7/45722880 + 773411*rr.^6/4082400 + 538927*rr.^5/850500 + 642734*rr.^4/467775 + 2091088*rr.^3/1403325 - 23168*rr.^2/45045 - 421762048*rr/127702575 - 5005877248/1915538625;
        elseif -7 < rr && rr <= -6
            ret = -rr.^15/87178291200 - rr.^14/838252800 - rr.^13/17791488 - 19*rr.^12/11975040 - 53*rr.^11/1774080 - 32227*rr.^10/81648000 - 24421*rr.^9/6531840 - 966457*rr.^8/38102400 - 1823393*rr.^7/15240960 - 5818427*rr.^6/16329600 - 255833*rr.^5/604800 + 78901349*rr.^4/59875200 + 17097977*rr.^3/2395008 + 56979607*rr.^2/3991680 + 14398288259*rr/1089728640 + 1005507698627/245188944000;
        elseif -6 < rr && rr <= -5
            ret = rr.^15/12454041600 + rr.^14/141523200 + 173*rr.^13/622702080 + rr.^12/155520 + 221*rr.^11/2280960 + 11519*rr.^10/11664000 + 44227*rr.^9/6531840 + 157289*rr.^8/5443200 + 152395*rr.^7/3048192 - 488741*rr.^6/2332800 - 1038857*rr.^5/604800 - 4187303*rr.^4/777600 - 101232611*rr.^3/11975040 - 2987689*rr.^2/673920 + 4590637187*rr/1089728640 + 163201885541/35026992000;
        elseif -5 < rr && rr <= -4
            ret = -rr.^15/2874009600 - rr.^14/39916800 - 113*rr.^13/143700480 - rr.^12/71280 - 13*rr.^11/84480 - 247*rr.^10/243000 - 61009*rr.^9/19595520 + 7069*rr.^8/907200 + 1137851*rr.^7/9144576 + 218939*rr.^6/388800 + 1620853*rr.^5/1360800 + 560257*rr.^4/1425600 - 32748677*rr.^3/8981280 - 703993*rr.^2/95040 - 301286857*rr/62868960 - 1606651889/5837832000;
        elseif -4 < rr && rr <= -3
            ret = rr.^15/958003200 + rr.^14/17107200 + 13*rr.^13/9580032 + 7*rr.^12/427680 + 221*rr.^11/2280960 + 91*rr.^10/2916000 - 4771*rr.^9/1306368 - 9859*rr.^8/388800 - 1057927*rr.^7/15240960 + 16957*rr.^6/1166400 + 93301*rr.^5/151200 + 6701891*rr.^4/4276800 + 3764137*rr.^3/2993760 - 163307*rr.^2/285120 - 3468455*rr/4191264 + 4094824493/17513496000;
        elseif -3 < rr && rr <= -2
            ret = -rr.^15/435456000 - rr.^14/10886400 - 29*rr.^13/21772800 - rr.^12/155520 + 13*rr.^11/345600 + 7033*rr.^10/11664000 + 79651*rr.^9/32659200 - 7337*rr.^8/5443200 - 630773*rr.^7/15240960 - 269467*rr.^6/2332800 - 61633*rr.^5/3024000 + 288599*rr.^4/777600 + 1946191*rr.^3/5443200 - 14339*rr.^2/51840 + 2566373*rr/38102400 + 21914742667/35026992000;
        elseif -2 < rr && rr <= -1
            ret = rr.^15/261273600 + rr.^14/10886400 + rr.^13/2612736 - rr.^12/155520 - 13*rr.^11/207360 - 403*rr.^10/11664000 + 30173*rr.^9/19595520 + 28127*rr.^8/5443200 - 298727*rr.^7/45722880 - 119603*rr.^6/2332800 - 88517*rr.^5/5443200 + 141751*rr.^4/777600 + 64649*rr.^3/3265920 - 9089*rr.^2/17280 + 171811*rr/22861440 + 3177441629/5003856000;
        elseif -1 < rr && rr <= 0
            ret = -rr.^15/203212800 - rr.^14/25401600 + rr.^13/1451520 + rr.^12/181440 - 13*rr.^11/483840 - 3211*rr.^10/13608000 + 143*rr.^9/435456 + 3223*rr.^8/793800 - 143*rr.^7/145152 - 11737*rr.^6/340200 + 81491*rr.^4/453600 - 16459*rr.^2/30240 + 12949745023/20432412000;
        elseif 0 < rr && rr <= 1
            ret = rr.^15/203212800 - rr.^14/25401600 - rr.^13/1451520 + rr.^12/181440 + 13*rr.^11/483840 - 3211*rr.^10/13608000 - 143*rr.^9/435456 + 3223*rr.^8/793800 + 143*rr.^7/145152 - 11737*rr.^6/340200 + 81491*rr.^4/453600 - 16459*rr.^2/30240 + 12949745023/20432412000;
        elseif 1 < rr && rr <= 2
            ret = -rr.^15/261273600 + rr.^14/10886400 - rr.^13/2612736 - rr.^12/155520 + 13*rr.^11/207360 - 403*rr.^10/11664000 - 30173*rr.^9/19595520 + 28127*rr.^8/5443200 + 298727*rr.^7/45722880 - 119603*rr.^6/2332800 + 88517*rr.^5/5443200 + 141751*rr.^4/777600 - 64649*rr.^3/3265920 - 9089*rr.^2/17280 - 171811*rr/22861440 + 3177441629/5003856000;
        elseif 2 < rr && rr <= 3
            ret = rr.^15/435456000 - rr.^14/10886400 + 29*rr.^13/21772800 - rr.^12/155520 - 13*rr.^11/345600 + 7033*rr.^10/11664000 - 79651*rr.^9/32659200 - 7337*rr.^8/5443200 + 630773*rr.^7/15240960 - 269467*rr.^6/2332800 + 61633*rr.^5/3024000 + 288599*rr.^4/777600 - 1946191*rr.^3/5443200 - 14339*rr.^2/51840 - 2566373*rr/38102400 + 21914742667/35026992000;
        elseif 3 < rr && rr <= 4
            ret = -rr.^15/958003200 + rr.^14/17107200 - 13*rr.^13/9580032 + 7*rr.^12/427680 - 221*rr.^11/2280960 + 91*rr.^10/2916000 + 4771*rr.^9/1306368 - 9859*rr.^8/388800 + 1057927*rr.^7/15240960 + 16957*rr.^6/1166400 - 93301*rr.^5/151200 + 6701891*rr.^4/4276800 - 3764137*rr.^3/2993760 - 163307*rr.^2/285120 + 3468455*rr/4191264 + 4094824493/17513496000;
        elseif 4 < rr && rr <= 5
            ret = rr.^15/2874009600 - rr.^14/39916800 + 113*rr.^13/143700480 - rr.^12/71280 + 13*rr.^11/84480 - 247*rr.^10/243000 + 61009*rr.^9/19595520 + 7069*rr.^8/907200 - 1137851*rr.^7/9144576 + 218939*rr.^6/388800 - 1620853*rr.^5/1360800 + 560257*rr.^4/1425600 + 32748677*rr.^3/8981280 - 703993*rr.^2/95040 + 301286857*rr/62868960 - 1606651889/5837832000;
        elseif 5 < rr && rr <= 6
            ret = -rr.^15/12454041600 + rr.^14/141523200 - 173*rr.^13/622702080 + rr.^12/155520 - 221*rr.^11/2280960 + 11519*rr.^10/11664000 - 44227*rr.^9/6531840 + 157289*rr.^8/5443200 - 152395*rr.^7/3048192 - 488741*rr.^6/2332800 + 1038857*rr.^5/604800 - 4187303*rr.^4/777600 + 101232611*rr.^3/11975040 - 2987689*rr.^2/673920 - 4590637187*rr/1089728640 + 163201885541/35026992000;
        elseif 6 < rr && rr <= 7
            ret = rr.^15/87178291200 - rr.^14/838252800 + rr.^13/17791488 - 19*rr.^12/11975040 + 53*rr.^11/1774080 - 32227*rr.^10/81648000 + 24421*rr.^9/6531840 - 966457*rr.^8/38102400 + 1823393*rr.^7/15240960 - 5818427*rr.^6/16329600 + 255833*rr.^5/604800 + 78901349*rr.^4/59875200 - 17097977*rr.^3/2395008 + 56979607*rr.^2/3991680 - 14398288259*rr/1089728640 + 1005507698627/245188944000;
        elseif 7 < rr && rr < 8
            ret = -rr.^15/1307674368000 + rr.^14/10897286400 - 47*rr.^13/9340531200 + rr.^12/5987520 - 299*rr.^11/79833600 + 2447*rr.^10/40824000 - 69019*rr.^9/97977600 + 58621*rr.^8/9525600 - 1825543*rr.^7/45722880 + 773411*rr.^6/4082400 - 538927*rr.^5/850500 + 642734*rr.^4/467775 - 2091088*rr.^3/1403325 - 23168*rr.^2/45045 + 421762048*rr/127702575 - 5005877248/1915538625;
        else
            ret = 0;
        end
    end
    
    if D == 1
        if -8 < rr && rr <= -7
            ret = rr.^14/87178291200 + rr.^13/778377600 + 47*rr.^12/718502400 + rr.^11/498960 + 299*rr.^10/7257600 + 2447*rr.^9/4082400 + 69019*rr.^8/10886400 + 58621*rr.^7/1190700 + 1825543*rr.^6/6531840 + 773411*rr.^5/680400 + 538927*rr.^4/170100 + 2570936*rr.^3/467775 + 2091088*rr.^2/467775 - 46336*rr/45045 - 421762048/127702575;
        elseif -7 < rr && rr <= -6
            ret = -rr.^14/5811886080 - rr.^13/59875200 - rr.^12/1368576 - 19*rr.^11/997920 - 53*rr.^10/161280 - 32227*rr.^9/8164800 - 24421*rr.^8/725760 - 966457*rr.^7/4762800 - 1823393*rr.^6/2177280 - 5818427*rr.^5/2721600 - 255833*rr.^4/120960 + 78901349*rr.^3/14968800 + 17097977*rr.^2/798336 + 56979607*rr/1995840 + 14398288259/1089728640;
        elseif -6 < rr && rr <= -5
            ret = rr.^14/830269440 + rr.^13/10108800 + 173*rr.^12/47900160 + rr.^11/12960 + 221*rr.^10/207360 + 11519*rr.^9/1166400 + 44227*rr.^8/725760 + 157289*rr.^7/680400 + 152395*rr.^6/435456 - 488741*rr.^5/388800 - 1038857*rr.^4/120960 - 4187303*rr.^3/194400 - 101232611*rr.^2/3991680 - 2987689*rr/336960 + 4590637187/1089728640;
        elseif -5 < rr && rr <= -4
            ret = -rr.^14/191600640 - rr.^13/2851200 - 1469*rr.^12/143700480 - rr.^11/5940 - 13*rr.^10/7680 - 247*rr.^9/24300 - 61009*rr.^8/2177280 + 7069*rr.^7/113400 + 1137851*rr.^6/1306368 + 218939*rr.^5/64800 + 1620853*rr.^4/272160 + 560257*rr.^3/356400 - 32748677*rr.^2/2993760 - 703993*rr/47520 - 301286857/62868960;
        elseif -4 < rr && rr <= -3
            ret = rr.^14/63866880 + 7*rr.^13/8553600 + 169*rr.^12/9580032 + 7*rr.^11/35640 + 221*rr.^10/207360 + 91*rr.^9/291600 - 4771*rr.^8/145152 - 9859*rr.^7/48600 - 1057927*rr.^6/2177280 + 16957*rr.^5/194400 + 93301*rr.^4/30240 + 6701891*rr.^3/1069200 + 3764137*rr.^2/997920 - 163307*rr/142560 - 3468455/4191264;
        elseif -3 < rr && rr <= -2
            ret = -rr.^14/29030400 - rr.^13/777600 - 377*rr.^12/21772800 - rr.^11/12960 + 143*rr.^10/345600 + 7033*rr.^9/1166400 + 79651*rr.^8/3628800 - 7337*rr.^7/680400 - 630773*rr.^6/2177280 - 269467*rr.^5/388800 - 61633*rr.^4/604800 + 288599*rr.^3/194400 + 1946191*rr.^2/1814400 - 14339*rr/25920 + 2566373/38102400;
        elseif -2 < rr && rr <= -1
            ret = rr.^14/17418240 + rr.^13/777600 + 13*rr.^12/2612736 - rr.^11/12960 - 143*rr.^10/207360 - 403*rr.^9/1166400 + 30173*rr.^8/2177280 + 28127*rr.^7/680400 - 298727*rr.^6/6531840 - 119603*rr.^5/388800 - 88517*rr.^4/1088640 + 141751*rr.^3/194400 + 64649*rr.^2/1088640 - 9089*rr/8640 + 171811/22861440;
        elseif -1 < rr && rr <= 0
            ret = -rr.^14/13547520 - rr.^13/1814400 + 13*rr.^12/1451520 + rr.^11/15120 - 143*rr.^10/483840 - 3211*rr.^9/1360800 + 143*rr.^8/48384 + 3223*rr.^7/99225 - 143*rr.^6/20736 - 11737*rr.^5/56700 + 81491*rr.^3/113400 - 16459*rr/15120;
        elseif 0 < rr && rr <= 1
            ret = rr.^14/13547520 - rr.^13/1814400 - 13*rr.^12/1451520 + rr.^11/15120 + 143*rr.^10/483840 - 3211*rr.^9/1360800 - 143*rr.^8/48384 + 3223*rr.^7/99225 + 143*rr.^6/20736 - 11737*rr.^5/56700 + 81491*rr.^3/113400 - 16459*rr/15120;
        elseif 1 < rr && rr <= 2
            ret = -rr.^14/17418240 + rr.^13/777600 - 13*rr.^12/2612736 - rr.^11/12960 + 143*rr.^10/207360 - 403*rr.^9/1166400 - 30173*rr.^8/2177280 + 28127*rr.^7/680400 + 298727*rr.^6/6531840 - 119603*rr.^5/388800 + 88517*rr.^4/1088640 + 141751*rr.^3/194400 - 64649*rr.^2/1088640 - 9089*rr/8640 - 171811/22861440;
        elseif 2 < rr && rr <= 3
            ret = rr.^14/29030400 - rr.^13/777600 + 377*rr.^12/21772800 - rr.^11/12960 - 143*rr.^10/345600 + 7033*rr.^9/1166400 - 79651*rr.^8/3628800 - 7337*rr.^7/680400 + 630773*rr.^6/2177280 - 269467*rr.^5/388800 + 61633*rr.^4/604800 + 288599*rr.^3/194400 - 1946191*rr.^2/1814400 - 14339*rr/25920 - 2566373/38102400;
        elseif 3 < rr && rr <= 4
            ret = -rr.^14/63866880 + 7*rr.^13/8553600 - 169*rr.^12/9580032 + 7*rr.^11/35640 - 221*rr.^10/207360 + 91*rr.^9/291600 + 4771*rr.^8/145152 - 9859*rr.^7/48600 + 1057927*rr.^6/2177280 + 16957*rr.^5/194400 - 93301*rr.^4/30240 + 6701891*rr.^3/1069200 - 3764137*rr.^2/997920 - 163307*rr/142560 + 3468455/4191264;
        elseif 4 < rr && rr <= 5
            ret = rr.^14/191600640 - rr.^13/2851200 + 1469*rr.^12/143700480 - rr.^11/5940 + 13*rr.^10/7680 - 247*rr.^9/24300 + 61009*rr.^8/2177280 + 7069*rr.^7/113400 - 1137851*rr.^6/1306368 + 218939*rr.^5/64800 - 1620853*rr.^4/272160 + 560257*rr.^3/356400 + 32748677*rr.^2/2993760 - 703993*rr/47520 + 301286857/62868960;
        elseif 5 < rr && rr <= 6
            ret = -rr.^14/830269440 + rr.^13/10108800 - 173*rr.^12/47900160 + rr.^11/12960 - 221*rr.^10/207360 + 11519*rr.^9/1166400 - 44227*rr.^8/725760 + 157289*rr.^7/680400 - 152395*rr.^6/435456 - 488741*rr.^5/388800 + 1038857*rr.^4/120960 - 4187303*rr.^3/194400 + 101232611*rr.^2/3991680 - 2987689*rr/336960 - 4590637187/1089728640;
        elseif 6 < rr && rr <= 7
            ret = rr.^14/5811886080 - rr.^13/59875200 + rr.^12/1368576 - 19*rr.^11/997920 + 53*rr.^10/161280 - 32227*rr.^9/8164800 + 24421*rr.^8/725760 - 966457*rr.^7/4762800 + 1823393*rr.^6/2177280 - 5818427*rr.^5/2721600 + 255833*rr.^4/120960 + 78901349*rr.^3/14968800 - 17097977*rr.^2/798336 + 56979607*rr/1995840 - 14398288259/1089728640;
        elseif 7 < rr && rr < 8
            ret = -rr.^14/87178291200 + rr.^13/778377600 - 47*rr.^12/718502400 + rr.^11/498960 - 299*rr.^10/7257600 + 2447*rr.^9/4082400 - 69019*rr.^8/10886400 + 58621*rr.^7/1190700 - 1825543*rr.^6/6531840 + 773411*rr.^5/680400 - 538927*rr.^4/170100 + 2570936*rr.^3/467775 - 2091088*rr.^2/467775 - 46336*rr/45045 + 421762048/127702575;
        else
            ret = 0;
        end
    end
    if D == 2
        if -8 < rr && rr <= -7
            ret = rr.^13/6227020800 + rr.^12/59875200 + 47*rr.^11/59875200 + rr.^10/45360 + 299*rr.^9/725760 + 2447*rr.^8/453600 + 69019*rr.^7/1360800 + 58621*rr.^6/170100 + 1825543*rr.^5/1088640 + 773411*rr.^4/136080 + 538927*rr.^3/42525 + 2570936*rr.^2/155925 + 4182176*rr/467775 - 46336/45045;
        elseif -7 < rr && rr <= -6
            ret = -rr.^13/415134720 - 13*rr.^12/59875200 - rr.^11/114048 - 19*rr.^10/90720 - 53*rr.^9/16128 - 32227*rr.^8/907200 - 24421*rr.^7/90720 - 966457*rr.^6/680400 - 1823393*rr.^5/362880 - 5818427*rr.^4/544320 - 255833*rr.^3/30240 + 78901349*rr.^2/4989600 + 17097977*rr/399168 + 56979607/1995840;
        elseif -6 < rr && rr <= -5
            ret = rr.^13/59304960 + rr.^12/777600 + 173*rr.^11/3991680 + 11*rr.^10/12960 + 221*rr.^9/20736 + 11519*rr.^8/129600 + 44227*rr.^7/90720 + 157289*rr.^6/97200 + 152395*rr.^5/72576 - 488741*rr.^4/77760 - 1038857*rr.^3/30240 - 4187303*rr.^2/64800 - 101232611*rr/1995840 - 2987689/336960;
        elseif -5 < rr && rr <= -4
            ret = -rr.^13/13685760 - 13*rr.^12/2851200 - 1469*rr.^11/11975040 - rr.^10/540 - 13*rr.^9/768 - 247*rr.^8/2700 - 61009*rr.^7/272160 + 7069*rr.^6/16200 + 1137851*rr.^5/217728 + 218939*rr.^4/12960 + 1620853*rr.^3/68040 + 560257*rr.^2/118800 - 32748677*rr/1496880 - 703993/47520;
        elseif -4 < rr && rr <= -3
            ret = rr.^13/4561920 + 91*rr.^12/8553600 + 169*rr.^11/798336 + 7*rr.^10/3240 + 221*rr.^9/20736 + 91*rr.^8/32400 - 4771*rr.^7/18144 - 69013*rr.^6/48600 - 1057927*rr.^5/362880 + 16957*rr.^4/38880 + 93301*rr.^3/7560 + 6701891*rr.^2/356400 + 3764137*rr/498960 - 163307/142560;
        elseif -3 < rr && rr <= -2
            ret = -rr.^13/2073600 - 13*rr.^12/777600 - 377*rr.^11/1814400 - 11*rr.^10/12960 + 143*rr.^9/34560 + 7033*rr.^8/129600 + 79651*rr.^7/453600 - 7337*rr.^6/97200 - 630773*rr.^5/362880 - 269467*rr.^4/77760 - 61633*rr.^3/151200 + 288599*rr.^2/64800 + 1946191*rr/907200 - 14339/25920;
        elseif -2 < rr && rr <= -1
            ret = rr.^13/1244160 + 13*rr.^12/777600 + 13*rr.^11/217728 - 11*rr.^10/12960 - 143*rr.^9/20736 - 403*rr.^8/129600 + 30173*rr.^7/272160 + 28127*rr.^6/97200 - 298727*rr.^5/1088640 - 119603*rr.^4/77760 - 88517*rr.^3/272160 + 141751*rr.^2/64800 + 64649*rr/544320 - 9089/8640;
        elseif -1 < rr && rr <= 0
            ret = -rr.^13/967680 - 13*rr.^12/1814400 + 13*rr.^11/120960 + 11*rr.^10/15120 - 143*rr.^9/48384 - 3211*rr.^8/151200 + 143*rr.^7/6048 + 3223*rr.^6/14175 - 143*rr.^5/3456 - 11737*rr.^4/11340 + 81491*rr.^2/37800 - 16459/15120;
        elseif 0 < rr && rr <= 1
            ret = rr.^13/967680 - 13*rr.^12/1814400 - 13*rr.^11/120960 + 11*rr.^10/15120 + 143*rr.^9/48384 - 3211*rr.^8/151200 - 143*rr.^7/6048 + 3223*rr.^6/14175 + 143*rr.^5/3456 - 11737*rr.^4/11340 + 81491*rr.^2/37800 - 16459/15120;
        elseif 1 < rr && rr <= 2
            ret = -rr.^13/1244160 + 13*rr.^12/777600 - 13*rr.^11/217728 - 11*rr.^10/12960 + 143*rr.^9/20736 - 403*rr.^8/129600 - 30173*rr.^7/272160 + 28127*rr.^6/97200 + 298727*rr.^5/1088640 - 119603*rr.^4/77760 + 88517*rr.^3/272160 + 141751*rr.^2/64800 - 64649*rr/544320 - 9089/8640;
        elseif 2 < rr && rr <= 3
            ret = rr.^13/2073600 - 13*rr.^12/777600 + 377*rr.^11/1814400 - 11*rr.^10/12960 - 143*rr.^9/34560 + 7033*rr.^8/129600 - 79651*rr.^7/453600 - 7337*rr.^6/97200 + 630773*rr.^5/362880 - 269467*rr.^4/77760 + 61633*rr.^3/151200 + 288599*rr.^2/64800 - 1946191*rr/907200 - 14339/25920;
        elseif 3 < rr && rr <= 4
            ret = -rr.^13/4561920 + 91*rr.^12/8553600 - 169*rr.^11/798336 + 7*rr.^10/3240 - 221*rr.^9/20736 + 91*rr.^8/32400 + 4771*rr.^7/18144 - 69013*rr.^6/48600 + 1057927*rr.^5/362880 + 16957*rr.^4/38880 - 93301*rr.^3/7560 + 6701891*rr.^2/356400 - 3764137*rr/498960 - 163307/142560;
        elseif 4 < rr && rr <= 5
            ret = rr.^13/13685760 - 13*rr.^12/2851200 + 1469*rr.^11/11975040 - rr.^10/540 + 13*rr.^9/768 - 247*rr.^8/2700 + 61009*rr.^7/272160 + 7069*rr.^6/16200 - 1137851*rr.^5/217728 + 218939*rr.^4/12960 - 1620853*rr.^3/68040 + 560257*rr.^2/118800 + 32748677*rr/1496880 - 703993/47520;
        elseif 5 < rr && rr <= 6
            ret = -rr.^13/59304960 + rr.^12/777600 - 173*rr.^11/3991680 + 11*rr.^10/12960 - 221*rr.^9/20736 + 11519*rr.^8/129600 - 44227*rr.^7/90720 + 157289*rr.^6/97200 - 152395*rr.^5/72576 - 488741*rr.^4/77760 + 1038857*rr.^3/30240 - 4187303*rr.^2/64800 + 101232611*rr/1995840 - 2987689/336960;
        elseif 6 < rr && rr <= 7
            ret = rr.^13/415134720 - 13*rr.^12/59875200 + rr.^11/114048 - 19*rr.^10/90720 + 53*rr.^9/16128 - 32227*rr.^8/907200 + 24421*rr.^7/90720 - 966457*rr.^6/680400 + 1823393*rr.^5/362880 - 5818427*rr.^4/544320 + 255833*rr.^3/30240 + 78901349*rr.^2/4989600 - 17097977*rr/399168 + 56979607/1995840;
        elseif 7 < rr && rr < 8
            ret = -rr.^13/6227020800 + rr.^12/59875200 - 47*rr.^11/59875200 + rr.^10/45360 - 299*rr.^9/725760 + 2447*rr.^8/453600 - 69019*rr.^7/1360800 + 58621*rr.^6/170100 - 1825543*rr.^5/1088640 + 773411*rr.^4/136080 - 538927*rr.^3/42525 + 2570936*rr.^2/155925 - 4182176*rr/467775 - 46336/45045;
        else
            ret = 0;
        end
    end
    if D == 3
        if -8 < rr && rr <= -7
            ret = rr.^12/479001600 + rr.^11/4989600 + 47*rr.^10/5443200 + rr.^9/4536 + 299*rr.^8/80640 + 2447*rr.^7/56700 + 69019*rr.^6/194400 + 58621*rr.^5/28350 + 1825543*rr.^4/217728 + 773411*rr.^3/34020 + 538927*rr.^2/14175 + 5141872*rr/155925 + 4182176/467775;
        elseif -7 < rr && rr <= -6
            ret = -rr.^12/31933440 - 13*rr.^11/4989600 - rr.^10/10368 - 19*rr.^9/9072 - 53*rr.^8/1792 - 32227*rr.^7/113400 - 24421*rr.^6/12960 - 966457*rr.^5/113400 - 1823393*rr.^4/72576 - 5818427*rr.^3/136080 - 255833*rr.^2/10080 + 78901349*rr/2494800 + 17097977/399168;
        elseif -6 < rr && rr <= -5
            ret = rr.^12/4561920 + rr.^11/64800 + 173*rr.^10/362880 + 11*rr.^9/1296 + 221*rr.^8/2304 + 11519*rr.^7/16200 + 44227*rr.^6/12960 + 157289*rr.^5/16200 + 761975*rr.^4/72576 - 488741*rr.^3/19440 - 1038857*rr.^2/10080 - 4187303*rr/32400 - 101232611/1995840;
        elseif -5 < rr && rr <= -4
            ret = -13*rr.^12/13685760 - 13*rr.^11/237600 - 1469*rr.^10/1088640 - rr.^9/54 - 39*rr.^8/256 - 494*rr.^7/675 - 61009*rr.^6/38880 + 7069*rr.^5/2700 + 5689255*rr.^4/217728 + 218939*rr.^3/3240 + 1620853*rr.^2/22680 + 560257*rr/59400 - 32748677/1496880;
        elseif -4 < rr && rr <= -3
            ret = 13*rr.^12/4561920 + 91*rr.^11/712800 + 169*rr.^10/72576 + 7*rr.^9/324 + 221*rr.^8/2304 + 91*rr.^7/4050 - 4771*rr.^6/2592 - 69013*rr.^5/8100 - 1057927*rr.^4/72576 + 16957*rr.^3/9720 + 93301*rr.^2/2520 + 6701891*rr/178200 + 3764137/498960;
        elseif -3 < rr && rr <= -2
            ret = -13*rr.^12/2073600 - 13*rr.^11/64800 - 4147*rr.^10/1814400 - 11*rr.^9/1296 + 143*rr.^8/3840 + 7033*rr.^7/16200 + 79651*rr.^6/64800 - 7337*rr.^5/16200 - 630773*rr.^4/72576 - 269467*rr.^3/19440 - 61633*rr.^2/50400 + 288599*rr/32400 + 1946191/907200;
        elseif -2 < rr && rr <= -1
            ret = 13*rr.^12/1244160 + 13*rr.^11/64800 + 143*rr.^10/217728 - 11*rr.^9/1296 - 143*rr.^8/2304 - 403*rr.^7/16200 + 30173*rr.^6/38880 + 28127*rr.^5/16200 - 298727*rr.^4/217728 - 119603*rr.^3/19440 - 88517*rr.^2/90720 + 141751*rr/32400 + 64649/544320;
        elseif -1 < rr && rr <= 0
            ret = rr*(-195*rr.^11 - 1248*rr.^10 + 17160*rr.^9 + 105600*rr.^8 - 386100*rr.^7 - 2466048*rr.^6 + 2402400*rr.^5 + 19802112*rr.^4 - 3003000*rr.^3 - 60093440*rr.^2 + 62585088)/14515200;
        elseif 0 < rr && rr <= 1
            ret = rr*(195*rr.^11 - 1248*rr.^10 - 17160*rr.^9 + 105600*rr.^8 + 386100*rr.^7 - 2466048*rr.^6 - 2402400*rr.^5 + 19802112*rr.^4 + 3003000*rr.^3 - 60093440*rr.^2 + 62585088)/14515200;
        elseif 1 < rr && rr <= 2
            ret = -13*rr.^12/1244160 + 13*rr.^11/64800 - 143*rr.^10/217728 - 11*rr.^9/1296 + 143*rr.^8/2304 - 403*rr.^7/16200 - 30173*rr.^6/38880 + 28127*rr.^5/16200 + 298727*rr.^4/217728 - 119603*rr.^3/19440 + 88517*rr.^2/90720 + 141751*rr/32400 - 64649/544320;
        elseif 2 < rr && rr <= 3
            ret = 13*rr.^12/2073600 - 13*rr.^11/64800 + 4147*rr.^10/1814400 - 11*rr.^9/1296 - 143*rr.^8/3840 + 7033*rr.^7/16200 - 79651*rr.^6/64800 - 7337*rr.^5/16200 + 630773*rr.^4/72576 - 269467*rr.^3/19440 + 61633*rr.^2/50400 + 288599*rr/32400 - 1946191/907200;
        elseif 3 < rr && rr <= 4
            ret = -13*rr.^12/4561920 + 91*rr.^11/712800 - 169*rr.^10/72576 + 7*rr.^9/324 - 221*rr.^8/2304 + 91*rr.^7/4050 + 4771*rr.^6/2592 - 69013*rr.^5/8100 + 1057927*rr.^4/72576 + 16957*rr.^3/9720 - 93301*rr.^2/2520 + 6701891*rr/178200 - 3764137/498960;
        elseif 4 < rr && rr <= 5
            ret = 13*rr.^12/13685760 - 13*rr.^11/237600 + 1469*rr.^10/1088640 - rr.^9/54 + 39*rr.^8/256 - 494*rr.^7/675 + 61009*rr.^6/38880 + 7069*rr.^5/2700 - 5689255*rr.^4/217728 + 218939*rr.^3/3240 - 1620853*rr.^2/22680 + 560257*rr/59400 + 32748677/1496880;
        elseif 5 < rr && rr <= 6
            ret = -rr.^12/4561920 + rr.^11/64800 - 173*rr.^10/362880 + 11*rr.^9/1296 - 221*rr.^8/2304 + 11519*rr.^7/16200 - 44227*rr.^6/12960 + 157289*rr.^5/16200 - 761975*rr.^4/72576 - 488741*rr.^3/19440 + 1038857*rr.^2/10080 - 4187303*rr/32400 + 101232611/1995840;
        elseif 6 < rr && rr <= 7
            ret = rr.^12/31933440 - 13*rr.^11/4989600 + rr.^10/10368 - 19*rr.^9/9072 + 53*rr.^8/1792 - 32227*rr.^7/113400 + 24421*rr.^6/12960 - 966457*rr.^5/113400 + 1823393*rr.^4/72576 - 5818427*rr.^3/136080 + 255833*rr.^2/10080 + 78901349*rr/2494800 - 17097977/399168;
        elseif 7 < rr && rr < 8
            ret = -rr.^12/479001600 + rr.^11/4989600 - 47*rr.^10/5443200 + rr.^9/4536 - 299*rr.^8/80640 + 2447*rr.^7/56700 - 69019*rr.^6/194400 + 58621*rr.^5/28350 - 1825543*rr.^4/217728 + 773411*rr.^3/34020 - 538927*rr.^2/14175 + 5141872*rr/155925 - 4182176/467775;
        else
            ret = 0;
        end
    end
    Ret(i) = ret / h.^D;
end

ret = reshape(Ret,size(r,1),size(r,2));
end
